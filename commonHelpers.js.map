{"version":3,"file":"commonHelpers.js","sources":["../src/img/basket_1x.png","../src/img/basket_2x.png","../src/JS/markup-cart-products.js","../src/JS/modal-cart.js","../src/cart.js"],"sourcesContent":["export default \"__VITE_ASSET__cca379fd__\"","export default \"__VITE_ASSET__84559eaa__\"","import icons from '../img/icons.svg';\nimport basket_1 from '../img/basket_1x.png';\nimport basket_2 from '../img/basket_2x.png';\n\nexport const cartFullMarkup = document.querySelector('.cart');\n\nexport const createListMarkup = () => {\n  const cartProductsInfo = JSON.parse(\n    localStorage.getItem('cart-products-list')\n  );\n  const cardsList = cartProductsInfo\n    .map(\n      ({ _id, name, img, category, price, size }) =>\n        `<li class=\"card_container_product\" id=\"${_id}\">\n\n         <div class=\"description\">\n          <div class=\"card_container-product_img\">\n            <img class=\"card_product_img\" src=\"${img}\" alt=\"${name}\" />\n          </div>\n\n          <div class=\"card_container_product_fullDs\">\n            <div class=\"card_container_product_name\">\n              <h3 class=\"card_product_name\">${name}</h3>\n            </div>\n            <div class=\"card_container_product_description\">\n              <div class=\"card-description\">\n                <p class=\"cart_product_description\">\n                  <span class=\"cart_product_span\">Category:</span>${category}\n                </p>\n                <p class=\"cart_product_description\">\n                  <span class=\"cart_product_span\">Size:</span>${size}\n                </p>\n              </div>\n            </div>\n            <div class=\"card_container_price\">\n              <p class=\"card_product_price\">$${price}</p>\n            </div>\n          </div>\n          <div class=\"card-product-delete-button\">\n            <button type=\"button\" class=\"cart-product-delete-button\" id=\"${_id}\">\n              <svg class=\"cart-icon-close\" width=\"18\" height=\"18\">\n                 <use href=\"${icons}#icon-delete-close\"></use>\n              </svg>\n            </button>\n          </div>\n        </div>\n\n    </li>`\n    )\n    .join('');\n\n  const cartProductsList = cartFullMarkup.querySelector('.cart-list');\n  cartProductsList.innerHTML = '';\n  cartProductsList.insertAdjacentHTML('afterbegin', cardsList);\n};\nconst createMarkup = () => {\n  return `<div class=\"container\">\n  <ul class=\"cart_list\">\n    <li class=\"cart-item\">\n      <svg class=\"cart-svg\" width=\"18\" height=\"18\">\n        <use href=\"${icons}#icon-cart\"></use>\n      </svg>\n    </li>\n    <li class=\"cart-item\">\n      <p class=\"cart_text\">Cart<span class=\"cart-span\">()</span></p>\n    </li>\n  </ul>\n  <div class=\"container_full_cart\">\n    <div class=\"full\">\n      <div class=\"cart-container-delete\">\n        <button type=\"button\" \n          class=\"cart-product-delete-all-button\" aria-label=\"Delete\">\n          <span class=\"cart-product-delete-span\">Delete all</span>\n          <svg aria-hidden=\"true\" class=\"cart-icon-delete-all\" width=\"20\" height=\"20\">\n            <use width=\"20\" height=\"20\" href=\"${icons}#icon-delete-close\"></use>\n          </svg>\n        </button>\n      </div>\n      <ul class=\"cart-list\">\n      </ul>\n    </div>\n    <div class=\"cart_container_total_price\">\n      <h3 class=\"cart_title\">Your Order</h3>\n      <div class=\"cart_total_price\">\n        <p class=\"cart_total_price_text\">Total</p>\n        <p class=\"cart_total_cost_span\">\n          Sum:\n          <span class=\"cart_total_cost\"> </span>\n        </p>\n      </div>\n      <div class=\"cart_container_form\">\n        <form action=\"\"></form>\n        <input\n          class=\"cart_form_input\"\n          type=\"email\"\n          id=\"checkout\"\n          name=\"checkout\"\n          placeholder=\"Mail: Enter your email\"\n        />\n        <button class=\"cart_form_button\" type=\"submit\">Checkout</button>\n      </div>\n    </div>\n  </div>\n</div>`;\n};\n\nexport const renderCartProducts = () => {\n  const productsArr =\n    JSON.parse(localStorage.getItem('cart-products-list')) || [];\n  if (productsArr.length > 0) {\n    cartFullMarkup.innerHTML = '';\n    cartFullMarkup.insertAdjacentHTML('afterbegin', createMarkup(productsArr));\n    createListMarkup();\n  } else {\n    cartFullMarkup.innerHTML = '';\n    const cartContainer = document.querySelector('.cart');\n    cartContainer.innerHTML += `<div class=\"container\">\n    <div class=\"empty-basket\">\n      <div class=\"basket_container\">\n        <ul class=\"basket_list\">\n          <li class=\"basket_item\">\n            <svg class=\"basket_svg\" width=\"18\" height=\"18\">\n              <use href=\"${icons}#icon-cart\"></use>\n            </svg>\n          </li>\n          <li class=\"basket_item\">\n            <p class=\"basket_text\">Cart<span class=\"basket_span\">(0)</span></p>\n          </li>\n        </ul>\n      </div>\n      <img\n        class=\"basket_img\"\n        srcset=\"${basket_1}, ${basket_2}\"\n        src=\"${basket_1}\"\n        alt=\"yellow shopping basket\"\n        width=\"132\"\n        height=\"114\"\n      />\n      <div class=\"basket_container_text\">\n        <h3 class=\"basket_title\">\n          Your basket is <span class=\"basket_title_span\">empty...</span>\n        </h3>\n        <p class=\"basket-text\">\n          Go to the main page to select your favorite products and add them to the\n          cart.\n        </p>\n      </div>\n    </div>\n  </div>`;\n  }\n};\n\nrenderCartProducts();\n","\n\nconst modalCartByBuy = document.querySelector('.modal-cart');\nconst modalCartClose = document.querySelector('.close-btn');\n\nexport function displayByBuyModal() {\n  modalCartByBuy.classList.remove('is-hidden');\n  document.body.style.overflow = 'hidden';\n}\n\n\nfunction handleModalClick(event) {\n  if (event.target === modalCartByBuy) {\n    closeModal();\n  }\n}\n\nfunction closeModal() {\n  modalCartByBuy.classList.add('is-hidden');\n  document.body.style.overflow = 'visible';\n}\n\nwindow.addEventListener('click', handleModalClick);\nmodalCartClose.addEventListener('click', closeModal);\n","import {\n  renderCartProducts,\n  createListMarkup,\n} from './JS/markup-cart-products';\nimport { displayByBuyModal } from './JS/modal-cart';\nimport { createNewOrder } from './JS/API';\nimport { showError } from './JS/helpers';\n\nconst containerFull = document.querySelector('.container_full_cart');\nconst handleCart = event => {\n  if (event.target.classList.contains('cart-icon-close')) {\n    const clickedButton = event.target.closest('.cart-product-delete-button');\n    deleteProductAndUpdateCart(clickedButton.id);\n    createListMarkup();\n    calculationTotalPrice();\n  }\n\n  if (\n    event.target.classList.contains('cart-product-delete-all-button') ||\n    event.target.classList.contains('cart-icon-delete-all')\n  ) {\n    deleteAllFromCart();\n  }\n};\n\nif (JSON.parse(localStorage.getItem('cart-products-list')).length) {\n  containerFull.addEventListener('click', handleCart);\n}\n\nfunction updateCartFromLocalStorage() {\n  const productsNumber = JSON.parse(\n    localStorage.getItem('cart-products-list')\n  ).length;\n  const quantityCart = document.querySelector('.quantity_products');\n  const quantityInCart = document.querySelector('.cart-span');\n  quantityCart.textContent = '(' + productsNumber + ')';\n  if (JSON.parse(localStorage.getItem('cart-products-list')).length) {\n    quantityInCart.textContent = '(' + productsNumber + ')';\n  }\n}\n\nupdateCartFromLocalStorage();\n\nfunction deleteProductAndUpdateCart(productId) {\n  let productsArr =\n    JSON.parse(localStorage.getItem('cart-products-list')) || [];\n  const indexToDelete = productsArr.findIndex(\n    product => product._id === productId\n  );\n  if (indexToDelete !== -1) {\n    productsArr.splice(indexToDelete, 1);\n    localStorage.setItem('cart-products-list', JSON.stringify(productsArr));\n    createListMarkup();\n    updateCartFromLocalStorage();\n  }\n}\n\nfunction deleteAllFromCart() {\n  localStorage.setItem('cart-products-list', JSON.stringify([]));\n  updateCartFromLocalStorage();\n  renderCartProducts();\n}\n\nfunction calculationTotalPrice() {\n  const objectProducts =\n    JSON.parse(localStorage.getItem('cart-products-list')) || [];\n  const totalPrice = objectProducts.reduce((acc, product) => {\n    return acc + product.price;\n  }, 0);\n  if (JSON.parse(localStorage.getItem('cart-products-list')).length) {\n    const totalPriceProducts = document.querySelector('.cart_total_cost');\n    totalPriceProducts.textContent = `$ ${totalPrice.toFixed(2)}`;\n  }\n}\ncalculationTotalPrice();\n\nconst cartBtnSubmit = document.querySelector('.cart_form_button');\n\nif (JSON.parse(localStorage.getItem('cart-products-list')).length) {\n  cartBtnSubmit.addEventListener('click', makeOrder);\n}\n\nasync function makeOrder() {\n  const emailInputValue = document.querySelector('.cart_form_input').value;\n  const objectProducts = JSON.parse(localStorage.getItem('cart-products-list'));\n  const orderData = objectProducts.map(product => {\n    return {\n      productId: product._id,\n      amount: product.amount,\n    };\n  });\n\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  if (!emailRegex.test(emailInputValue)) {\n    showError('Please, enter valid Email!');\n    return;\n  }\n\n  const requestObj = {\n    email: emailInputValue,\n    products: orderData,\n  };\n  try {\n    const response = await createNewOrder(requestObj);\n    deleteAllFromCart();\n    displayByBuyModal(response);\n  } catch (error) {\n    console.error('Error creating order:', error);\n    showError('Error creating order. Please try again later.');\n  }\n}\n"],"names":["basket_1","basket_2","cartFullMarkup","createListMarkup","cardsList","_id","name","img","category","price","size","icons","cartProductsList","createMarkup","renderCartProducts","cartContainer","modalCartByBuy","modalCartClose","displayByBuyModal","handleModalClick","event","closeModal","containerFull","handleCart","clickedButton","deleteProductAndUpdateCart","calculationTotalPrice","deleteAllFromCart","updateCartFromLocalStorage","productsNumber","quantityCart","quantityInCart","productId","productsArr","indexToDelete","product","totalPrice","acc","totalPriceProducts","cartBtnSubmit","makeOrder","emailInputValue","orderData","showError","requestObj","response","createNewOrder","error"],"mappings":"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"}