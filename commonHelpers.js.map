{"version":3,"file":"commonHelpers.js","sources":["../src/JS/markup-cart-products.js","../src/JS/modal-cart.js","../src/cart.js"],"sourcesContent":["export const cartProductsList = document.querySelector('.cart-list');\n\nconst cartProductsInfo = JSON.parse(localStorage.getItem('cart-products-list'));\n\nconst createMarkup = cartProductsInfo => {\n  return cartProductsInfo\n    .map(\n      ({\n        _id,\n        name,\n        img,\n        category,\n        price,\n        size,\n        popularity,\n        quantity,\n        is10PercentOff,\n        desc,\n      }) =>\n        `<li class=\"card_container_product\" id=\"${_id}\">\n\n         <div class=\"description\">\n          <div class=\"card_container-product_img\">\n            <img class=\"card_product_img\" src=\"${img}\" alt=\"${name}\" />\n          </div>\n\n          <div class=\"card_container_product_fullDs\">\n            <div class=\"card_container_product_name\">\n              <h3 class=\"card_product_name\">${name}</h3>\n            </div>\n            <div class=\"card_container_product_description\">\n              <div class=\"card-description\">\n                <p class=\"cart_product_description\">\n                  <span class=\"cart_product_span\">Category:</span>${category}\n                </p>\n                <p class=\"cart_product_description\">\n                  <span class=\"cart_product_span\">Size:</span>${size}\n                </p>\n              </div>\n            </div>\n            <div class=\"card_container_price\">\n              <p class=\"card_product_price\">$${price}</p>\n            </div>\n          </div>\n          <div class=\"card-product-delete-button\">\n            <button type=\"button\" class=\"cart-product-delete-button id=\"${_id}\">\n              <svg class=\"cart-icon-close-\" width=\"18\" height=\"18\">\n                 <use href=\"./img/icons.svg#icon-delete-close\"></use>\n              </svg>\n            </button>\n          </div>\n        </div>\n\n    </li>`\n    )\n    .join('');\n};\n\nexport const renderCartProducts = () => {\n  cartProductsList.innerHTML = ''\n  cartProductsList.insertAdjacentHTML(\n    'afterbegin',\n    createMarkup(cartProductsInfo)\n  );\n};\n\nexport const updateCartProducts = () => {\n  const productsArr = JSON.parse(localStorage.getItem('cart-products-list')) || [];\n  cartProductsList.innerHTML = '';\n  cartProductsList.insertAdjacentHTML('afterbegin', createMarkup(productsArr));\n};\n\n","\n\nconst modalCartByBuy = document.querySelector('.modal-cart');\nconst modalCartClose = document.querySelector('.close-btn');\n\nexport function displayByBuyModal() {\n  modalCartByBuy.classList.remove('is-hidden');\n  document.body.style.overflow = 'hidden';\n}\n\n\nfunction handleModalClick(event) {\n  if (event.target === modalCartByBuy) {\n    closeModal();\n  }\n}\n\nfunction closeModal() {\n  modalCartByBuy.classList.add('is-hidden');\n  document.body.style.overflow = 'visible';\n}\n\nwindow.addEventListener('click', handleModalClick);\nmodalCartClose.addEventListener('click', closeModal);\n","import {\n  renderCartProducts,\n  cartProductsList,\n  updateCartProducts,\n} from './JS/markup-cart-products';\nimport { displayByBuyModal } from './JS/modal-cart';\nimport { createNewOrder } from './JS/API';\nimport { showError } from './JS/helpers';\n\nrenderCartProducts();\n\nfunction updateCartFromLocalStorage() {\n  const productsInLocalStorage =\n    JSON.parse(localStorage.getItem('cart-products-list')) || [];\n  const objectsCount = productsInLocalStorage.length;\n  const quantityCart = document.querySelector('.quantity_products');\n  const quantityCartIcon = document.querySelector('.cart-span');\n  quantityCart.textContent = '(' + objectsCount + ')';\n  quantityCartIcon.textContent = '(' + objectsCount + ')';\n}\n\nupdateCartFromLocalStorage();\n\nconst deleteAllButton = document.querySelector(\n  '.cart-product-delete-all-button'\n);\n\nfunction deleteProductAndUpdateCart(productId) {\n  let productsArr =\n    JSON.parse(localStorage.getItem('cart-products-list')) || [];\n  const indexToDelete = productsArr.findIndex(\n    product => product._id === productId\n  );\n\n  if (indexToDelete !== -1) {\n    productsArr.splice(indexToDelete, 1);\n    localStorage.setItem('cart-products-list', JSON.stringify(productsArr));\n    updateCartProducts();\n    updateCartFromLocalStorage();\n  } else {\n    console.log('Product not found in cart');\n  }\n}\n\nconst cartContainer = document.querySelector('.cart-list');\n\nasync function handleProductClick(event) {\n  const clickedButton = event.target.closest('.card-product-delete-button');\n  if (clickedButton) {\n    const productId = clickedButton.closest('.card_container_product').id;\n    deleteProductAndUpdateCart(productId);\n  }\n  calculationTotalPrice();\n}\n\ncartContainer.addEventListener('click', handleProductClick);\n\nfunction deleteAllFromCart() {\n  localStorage.setItem('cart-products-list', JSON.stringify([]));\n  cartProductsList.innerHTML = '';\n  updateCartFromLocalStorage();\n  calculationTotalPrice();\n}\n\ndeleteAllButton.addEventListener('click', deleteAllFromCart);\nconst totalPriceProducts = document.querySelector('.cart_total_cost');\nfunction calculationTotalPrice() {\n  const objectProducts = JSON.parse(localStorage.getItem('cart-products-list'));\n  const totalPrice = objectProducts.reduce((acc, product) => {\n    return acc + product.price;\n  }, 0);\n  totalPriceProducts.textContent = `$ ${totalPrice.toFixed(2)}`;\n}\ncalculationTotalPrice();\n\nconst cartBtnSubmit = document.querySelector('.cart_form_button');\ncartBtnSubmit.addEventListener('click', makeOrder);\n\nasync function makeOrder() {\n  const emailInputValue = document.querySelector('.cart_form_input').value;\n  const objectProducts = JSON.parse(localStorage.getItem('cart-products-list'));\n  const orderData = objectProducts.map(product => {\n    return {\n      productId: product._id,\n      amount: product.amount,\n    };\n  });\n\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  if (!emailRegex.test(emailInputValue)) {\n    showError('Please, enter valid Email!');\n    return;\n  }\n\n  const requestObj = {\n    email: emailInputValue,\n    products: orderData,\n  };\n  try {\n    const response = await createNewOrder(requestObj);\n    deleteAllFromCart();\n    displayByBuyModal(response);\n  } catch (error) {\n    console.error('Error creating order:', error);\n    showError('Error creating order. Please try again later.');\n  }\n}\n"],"names":["cartProductsList","cartProductsInfo","createMarkup","_id","name","img","category","price","size","popularity","quantity","is10PercentOff","desc","renderCartProducts","updateCartProducts","productsArr","modalCartByBuy","modalCartClose","displayByBuyModal","handleModalClick","event","closeModal","updateCartFromLocalStorage","objectsCount","quantityCart","quantityCartIcon","deleteAllButton","deleteProductAndUpdateCart","productId","indexToDelete","product","cartContainer","handleProductClick","clickedButton","calculationTotalPrice","deleteAllFromCart","totalPriceProducts","totalPrice","acc","cartBtnSubmit","makeOrder","emailInputValue","orderData","showError","requestObj","response","createNewOrder","error"],"mappings":"wGAAO,MAAMA,EAAmB,SAAS,cAAc,YAAY,EAE7DC,EAAmB,KAAK,MAAM,aAAa,QAAQ,oBAAoB,CAAC,EAExEC,EAAeD,GACZA,EACJ,IACC,CAAC,CACC,IAAAE,EACA,KAAAC,EACA,IAAAC,EACA,SAAAC,EACA,MAAAC,EACA,KAAAC,EACA,WAAAC,EACA,SAAAC,EACA,eAAAC,EACA,KAAAC,CACD,IACC,0CAA0CT;AAAA;AAAA;AAAA;AAAA,iDAIDE,WAAaD;AAAA;AAAA;AAAA;AAAA;AAAA,8CAKhBA;AAAA;AAAA;AAAA;AAAA;AAAA,oEAKsBE;AAAA;AAAA;AAAA,gEAGJE;AAAA;AAAA;AAAA;AAAA;AAAA,+CAKjBD;AAAA;AAAA;AAAA;AAAA,0EAI2BJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UASrE,EACA,KAAK,EAAE,EAGCU,EAAqB,IAAM,CACtCb,EAAiB,UAAY,GAC7BA,EAAiB,mBACf,aACAE,EAAaD,CAAgB,CACjC,CACA,EAEaa,EAAqB,IAAM,CACtC,MAAMC,EAAc,KAAK,MAAM,aAAa,QAAQ,oBAAoB,CAAC,GAAK,GAC9Ef,EAAiB,UAAY,GAC7BA,EAAiB,mBAAmB,aAAcE,EAAaa,CAAW,CAAC,CAC7E,ECpEMC,EAAiB,SAAS,cAAc,aAAa,EACrDC,EAAiB,SAAS,cAAc,YAAY,EAEnD,SAASC,GAAoB,CAClCF,EAAe,UAAU,OAAO,WAAW,EAC3C,SAAS,KAAK,MAAM,SAAW,QACjC,CAGA,SAASG,EAAiBC,EAAO,CAC3BA,EAAM,SAAWJ,GACnBK,GAEJ,CAEA,SAASA,GAAa,CACpBL,EAAe,UAAU,IAAI,WAAW,EACxC,SAAS,KAAK,MAAM,SAAW,SACjC,CAEA,OAAO,iBAAiB,QAASG,CAAgB,EACjDF,EAAe,iBAAiB,QAASI,CAAU,ECdnDR,IAEA,SAASS,GAA6B,CAGpC,MAAMC,GADJ,KAAK,MAAM,aAAa,QAAQ,oBAAoB,CAAC,GAAK,IAChB,OACtCC,EAAe,SAAS,cAAc,oBAAoB,EAC1DC,EAAmB,SAAS,cAAc,YAAY,EAC5DD,EAAa,YAAc,IAAMD,EAAe,IAChDE,EAAiB,YAAc,IAAMF,EAAe,GACtD,CAEAD,IAEA,MAAMI,EAAkB,SAAS,cAC/B,iCACF,EAEA,SAASC,EAA2BC,EAAW,CAC7C,IAAIb,EACF,KAAK,MAAM,aAAa,QAAQ,oBAAoB,CAAC,GAAK,GAC5D,MAAMc,EAAgBd,EAAY,UAChCe,GAAWA,EAAQ,MAAQF,CAC/B,EAEMC,IAAkB,IACpBd,EAAY,OAAOc,EAAe,CAAC,EACnC,aAAa,QAAQ,qBAAsB,KAAK,UAAUd,CAAW,CAAC,EACtED,IACAQ,KAEA,QAAQ,IAAI,2BAA2B,CAE3C,CAEA,MAAMS,EAAgB,SAAS,cAAc,YAAY,EAEzD,eAAeC,EAAmBZ,EAAO,CACvC,MAAMa,EAAgBb,EAAM,OAAO,QAAQ,6BAA6B,EACxE,GAAIa,EAAe,CACjB,MAAML,EAAYK,EAAc,QAAQ,yBAAyB,EAAE,GACnEN,EAA2BC,CAAS,CACrC,CACDM,GACF,CAEAH,EAAc,iBAAiB,QAASC,CAAkB,EAE1D,SAASG,GAAoB,CAC3B,aAAa,QAAQ,qBAAsB,KAAK,UAAU,CAAE,CAAA,CAAC,EAC7DnC,EAAiB,UAAY,GAC7BsB,IACAY,GACF,CAEAR,EAAgB,iBAAiB,QAASS,CAAiB,EAC3D,MAAMC,EAAqB,SAAS,cAAc,kBAAkB,EACpE,SAASF,GAAwB,CAE/B,MAAMG,EADiB,KAAK,MAAM,aAAa,QAAQ,oBAAoB,CAAC,EAC1C,OAAO,CAACC,EAAKR,IACtCQ,EAAMR,EAAQ,MACpB,CAAC,EACJM,EAAmB,YAAc,KAAKC,EAAW,QAAQ,CAAC,GAC5D,CACAH,IAEA,MAAMK,EAAgB,SAAS,cAAc,mBAAmB,EAChEA,EAAc,iBAAiB,QAASC,CAAS,EAEjD,eAAeA,GAAY,CACzB,MAAMC,EAAkB,SAAS,cAAc,kBAAkB,EAAE,MAE7DC,EADiB,KAAK,MAAM,aAAa,QAAQ,oBAAoB,CAAC,EAC3C,IAAIZ,IAC5B,CACL,UAAWA,EAAQ,IACnB,OAAQA,EAAQ,MACtB,EACG,EAGD,GAAI,CADe,6BACH,KAAKW,CAAe,EAAG,CACrCE,EAAU,4BAA4B,EACtC,MACD,CAED,MAAMC,EAAa,CACjB,MAAOH,EACP,SAAUC,CACd,EACE,GAAI,CACF,MAAMG,EAAW,MAAMC,EAAeF,CAAU,EAChDT,IACAjB,EAAkB2B,CAAQ,CAC3B,OAAQE,EAAP,CACA,QAAQ,MAAM,wBAAyBA,CAAK,EAC5CJ,EAAU,+CAA+C,CAC1D,CACH"}