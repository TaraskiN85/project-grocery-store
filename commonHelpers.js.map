{"version":3,"file":"commonHelpers.js","sources":["../src/JS/markup-cart-products.js","../src/JS/modal-cart.js","../src/cart.js"],"sourcesContent":["export const cartProductsList = document.querySelector('.cart');\n\nconst cartProductsInfo = JSON.parse(localStorage.getItem('cart-products-list'));\n\nconst createMarkup = cartProductsInfo => {\n  const cardsList = cartProductsInfo\n    .map(\n      ({\n        _id,\n        name,\n        img,\n        category,\n        price,\n        size,\n        popularity,\n        quantity,\n        is10PercentOff,\n        desc,\n      }) =>\n        `<li class=\"card_container_product\" id=\"${_id}\">\n\n         <div class=\"description\">\n          <div class=\"card_container-product_img\">\n            <img class=\"card_product_img\" src=\"${img}\" alt=\"${name}\" />\n          </div>\n\n          <div class=\"card_container_product_fullDs\">\n            <div class=\"card_container_product_name\">\n              <h3 class=\"card_product_name\">${name}</h3>\n            </div>\n            <div class=\"card_container_product_description\">\n              <div class=\"card-description\">\n                <p class=\"cart_product_description\">\n                  <span class=\"cart_product_span\">Category:</span>${category}\n                </p>\n                <p class=\"cart_product_description\">\n                  <span class=\"cart_product_span\">Size:</span>${size}\n                </p>\n              </div>\n            </div>\n            <div class=\"card_container_price\">\n              <p class=\"card_product_price\">$${price}</p>\n            </div>\n          </div>\n          <div class=\"card-product-delete-button\">\n            <button type=\"button\" class=\"cart-product-delete-button id=\"${_id}\">\n              <svg class=\"cart-icon-close-\" width=\"18\" height=\"18\">\n                 <use href=\"./img/icons.svg#icon-delete-close\"></use>\n              </svg>\n            </button>\n          </div>\n        </div>\n\n    </li>`\n    )\n    .join('');\n  return `  <div class=\"container\">\n  <ul class=\"cart_list\">\n    <li class=\"cart-item\">\n      <svg class=\"cart-svg\" width=\"18\" height=\"18\">\n        <use href=\"./img/icons.svg#icon-cart\"></use>\n      </svg>\n    </li>\n    <li class=\"cart-item\">\n      <p class=\"cart_text\">Cart<span class=\"cart-span\">()</span></p>\n    </li>\n  </ul>\n  <div class=\"container_full_cart\">\n    <div class=\"full\">\n      <div class=\"cart-container-delete\">\n        <span class=\"cart-product-delete-span\">Delete all</span>\n        <button type=\"button\" class=\"cart-product-delete-all-button\">\n          <svg class=\"cart-icon-delete-all\" width=\"24\" height=\"24\">\n            <use href=\"./img/icons.svg#icon-delete-close\"></use>\n          </svg>\n        </button>\n      </div>\n      <ul class=\"cart-list\">\n        ${cardsList}\n      </ul>\n    </div>\n    <div class=\"cart_container_total_price\">\n      <h3 class=\"cart_title\">Your Order</h3>\n      <div class=\"cart_total_price\">\n        <p class=\"cart_total_price_text\">Total</p>\n        <p class=\"cart_total_cost_span\">\n          Sum:\n          <span class=\"cart_total_cost\"> </span>\n        </p>\n      </div>\n      <div class=\"cart_container_form\">\n        <form action=\"\"></form>\n        <input\n          class=\"cart_form_input\"\n          type=\"email\"\n          id=\"checkout\"\n          name=\"checkout\"\n          placeholder=\"Mail: Enter your email\"\n        />\n        <button class=\"cart_form_button\" type=\"submit\">Checkout</button>\n      </div>\n    </div>\n  </div>\n</div>`;\n};\n\nexport const renderCartProducts = () => {\n  const productsArr =\n    JSON.parse(localStorage.getItem('cart-products-list')) || [];\n  if (productsArr.length > 0) {\n    console.log('full');\n    cartProductsList.innerHTML = '';\n    cartProductsList.insertAdjacentHTML(\n      'afterbegin',\n      createMarkup(productsArr)\n    );\n  } else {\n    cartProductsList.innerHTML = '';\n    console.log('empty');\n    const cartContainer = document.querySelector('.cart');\n    cartContainer.innerHTML += `<div class=\"container\">\n    <div class=\"empty-basket\">\n      <div class=\"basket_container\">\n        <ul class=\"basket_list\">\n          <li class=\"basket_item\">\n            <svg class=\"basket_svg\" width=\"18\" height=\"18\">\n              <use href=\"./img/icons.svg#icon-cart\"></use>\n            </svg>\n          </li>\n          <li class=\"basket_item\">\n            <p class=\"basket_text\">Cart<span class=\"basket_span\">(0)</span></p>\n          </li>\n        </ul>\n      </div>\n      <img\n        class=\"basket_img\"\n        srcset=\"./img/basket_1x.png, ./img/basket_2x.png\"\n        src=\"./img/basket_1x.png\"\n        alt=\"yellow shopping basket\"\n        width=\"132\"\n        height=\"114\"\n      />\n      <div class=\"basket_container_text\">\n        <h3 class=\"basket_title\">\n          Your basket is <span class=\"basket_title_span\">empty...</span>\n        </h3>\n        <p class=\"basket-text\">\n          Go to the main page to select your favorite products and add them to the\n          cart.\n        </p>\n      </div>\n    </div>\n  </div>`;\n  }\n};\n","\n\nconst modalCartByBuy = document.querySelector('.modal-cart');\nconst modalCartClose = document.querySelector('.close-btn');\n\nexport function displayByBuyModal() {\n  modalCartByBuy.classList.remove('is-hidden');\n  document.body.style.overflow = 'hidden';\n}\n\n\nfunction handleModalClick(event) {\n  if (event.target === modalCartByBuy) {\n    closeModal();\n  }\n}\n\nfunction closeModal() {\n  modalCartByBuy.classList.add('is-hidden');\n  document.body.style.overflow = 'visible';\n}\n\nwindow.addEventListener('click', handleModalClick);\nmodalCartClose.addEventListener('click', closeModal);\n","import {\n  renderCartProducts,\n  cartProductsList,\n} from './JS/markup-cart-products';\nimport { displayByBuyModal } from './JS/modal-cart';\nimport { createNewOrder } from './JS/API';\nimport { showError } from './JS/helpers';\n\nrenderCartProducts();\n\nfunction updateCartFromLocalStorage() {\n  const productsInLocalStorage =\n    JSON.parse(localStorage.getItem('cart-products-list')) || [];\n  const objectsCount = productsInLocalStorage.length;\n  const quantityCart = document.querySelector('.quantity_products');\n  const quantityCartIcon = document.querySelector('.cart-span');\n  quantityCart.textContent = '(' + objectsCount + ')';\n  if (JSON.parse(localStorage.getItem('cart-products-list')).length) {\n    quantityCartIcon.textContent = '(' + objectsCount + ')';\n  }\n}\n\nupdateCartFromLocalStorage();\n\nconst deleteAllButton = document.querySelector(\n  '.cart-product-delete-all-button'\n);\n\nfunction deleteProductAndUpdateCart(productId) {\n  let productsArr =\n    JSON.parse(localStorage.getItem('cart-products-list')) || [];\n  const indexToDelete = productsArr.findIndex(\n    product => product._id === productId\n  );\n\n  if (indexToDelete !== -1) {\n    productsArr.splice(indexToDelete, 1);\n    localStorage.setItem('cart-products-list', JSON.stringify(productsArr));\n    renderCartProducts();\n    updateCartFromLocalStorage();\n  }\n}\n\nconst cartContainer = document.querySelector('.cart-list');\n\nfunction handleContainerClick(event) {\n  const clickedButton = event.target.closest('.card-product-delete-button');\n\n  if (clickedButton) {\n    const productId = clickedButton.closest('.card_container_product').id;\n    deleteProductAndUpdateCart(productId);\n    calculationTotalPrice();\n  }\n}\n\ndocument.addEventListener('click', handleContainerClick);\n\nfunction deleteAllFromCart() {\n  localStorage.setItem('cart-products-list', JSON.stringify([]));\n  cartProductsList.innerHTML = '';\n  updateCartFromLocalStorage();\n  calculationTotalPrice();\n  renderCartProducts();\n}\n\nif (JSON.parse(localStorage.getItem('cart-products-list')).length) {\n  deleteAllButton.addEventListener('click', deleteAllFromCart);\n}\nconst totalPriceProducts = document.querySelector('.cart_total_cost');\nfunction calculationTotalPrice() {\n  const objectProducts = JSON.parse(localStorage.getItem('cart-products-list'));\n  const totalPrice = objectProducts.reduce((acc, product) => {\n    return acc + product.price;\n  }, 0);\n  if (JSON.parse(localStorage.getItem('cart-products-list')).length) {\n    totalPriceProducts.textContent = `$ ${totalPrice.toFixed(2)}`;\n  }\n}\ncalculationTotalPrice();\n\nconst cartBtnSubmit = document.querySelector('.cart_form_button');\n\nif (JSON.parse(localStorage.getItem('cart-products-list')).length) {\n  cartBtnSubmit.addEventListener('click', makeOrder);\n}\n\nasync function makeOrder() {\n  const emailInputValue = document.querySelector('.cart_form_input').value;\n  const objectProducts = JSON.parse(localStorage.getItem('cart-products-list'));\n  const orderData = objectProducts.map(product => {\n    return {\n      productId: product._id,\n      amount: product.amount,\n    };\n  });\n\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  if (!emailRegex.test(emailInputValue)) {\n    showError('Please, enter valid Email!');\n    return;\n  }\n\n  const requestObj = {\n    email: emailInputValue,\n    products: orderData,\n  };\n  try {\n    const response = await createNewOrder(requestObj);\n    deleteAllFromCart();\n    displayByBuyModal(response);\n  } catch (error) {\n    console.error('Error creating order:', error);\n    showError('Error creating order. Please try again later.');\n  }\n}\n"],"names":["cartProductsList","createMarkup","cartProductsInfo","_id","name","img","category","price","size","popularity","quantity","is10PercentOff","desc","renderCartProducts","productsArr","cartContainer","modalCartByBuy","modalCartClose","displayByBuyModal","handleModalClick","event","closeModal","updateCartFromLocalStorage","objectsCount","quantityCart","quantityCartIcon","deleteAllButton","deleteProductAndUpdateCart","productId","indexToDelete","product","handleContainerClick","clickedButton","calculationTotalPrice","deleteAllFromCart","totalPriceProducts","totalPrice","acc","cartBtnSubmit","makeOrder","emailInputValue","orderData","showError","requestObj","response","createNewOrder","error"],"mappings":"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"}